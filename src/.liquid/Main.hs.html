<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/Users/matt/dev/haskell/weight-tracker/src/Main.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE OverloadedStrings, TupleSections #-}</span></a>
<span class=hs-linenum>  2: </span>
<span class=hs-linenum>  3: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Main</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  4: </span>
<span class=hs-linenum>  5: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Date</span>                                     <span class='hs-layout'>(</span> <span class='hs-varid'>getCurrentTimeText</span>
<span class=hs-linenum>  6: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>readDate</span>
<span class=hs-linenum>  7: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>shortPrettyPrintTime</span>
<span class=hs-linenum>  8: </span>                                                          <span class='hs-layout'>)</span>
<span class=hs-linenum>  9: </span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Control.Foldl</span>                 <span class='hs-keyword'>as</span> <span class='hs-conid'>Foldl</span>
<span class=hs-linenum> 11: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Control.Monad.IO.Class</span>                   <span class='hs-layout'>(</span> <span class='hs-varid'>liftIO</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 12: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Control.Monad</span>                            <span class='hs-layout'>(</span> <span class='hs-varid'>forM_</span>
<span class=hs-linenum> 13: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>mzero</span>
<span class=hs-linenum> 14: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>when</span>
<span class=hs-linenum> 15: </span>                                                          <span class='hs-layout'>)</span>
<span class=hs-linenum> 16: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.HashMap.Strict</span>           <span class='hs-keyword'>as</span> <span class='hs-conid'>HM</span>
<span class=hs-linenum> 17: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.List</span>                     <span class='hs-keyword'>as</span> <span class='hs-conid'>L</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.List.Split</span> <span class='hs-layout'>(</span><span class='hs-varid'>divvy</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Maybe</span>                               <span class='hs-layout'>(</span> <span class='hs-varid'>catMaybes</span>
<span class=hs-linenum> 20: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>mapMaybe</span>
<span class=hs-linenum> 21: </span>                                                          <span class='hs-layout'>)</span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Ord</span>                                 <span class='hs-layout'>(</span> <span class='hs-varid'>comparing</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 23: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Text</span>                                <span class='hs-layout'>(</span> <span class='hs-conid'>Text</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 24: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Text</span>                     <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data.Time</span>
<span class=hs-linenum> 26: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Text.Read</span>                                <span class='hs-layout'>(</span> <span class='hs-varid'>readMaybe</span> <span class='hs-layout'>)</span>
<span class=hs-linenum> 27: </span><span class='hs-keyword'>import</span>           <span class='hs-conid'>Turtle</span>                                   <span class='hs-layout'>(</span> <span class='hs-conid'>Line</span>
<span class=hs-linenum> 28: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-conid'>FilePath</span>
<span class=hs-linenum> 29: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-conid'>Parser</span>
<span class=hs-linenum> 30: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-conid'>Shell</span>
<span class=hs-linenum> 31: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>argDouble</span>
<span class=hs-linenum> 32: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>cp</span>
<span class=hs-linenum> 33: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>fold</span>
<span class=hs-linenum> 34: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>input</span>
<span class=hs-linenum> 35: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>lineToText</span>
<span class=hs-linenum> 36: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>optional</span>
<span class=hs-linenum> 37: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>output</span>
<span class=hs-linenum> 38: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>options</span>
<span class=hs-linenum> 39: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>sh</span>
<span class=hs-linenum> 40: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-varid'>unsafeTextToLine</span>
<span class=hs-linenum> 41: </span>                                                          <span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;|&gt;</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 42: </span>                                                          <span class='hs-layout'>)</span>
<span class=hs-linenum> 43: </span>
<span class=hs-linenum> 44: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Weight</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Weight</span> <span class='hs-conid'>Double</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Show</span>
<span class=hs-linenum> 45: </span>
<span class=hs-linenum> 46: </span><span class='hs-definition'>fromWeight</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Weight</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum> 47: </span><a class=annot href="#"><span class=annottext>Main.Weight -&gt; GHC.Types.Double</span><span class='hs-definition'>fromWeight</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Weight</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>w</span>
<span class=hs-linenum> 48: </span>
<span class=hs-linenum> 49: </span><span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 50: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-definition'>main</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 51: </span>  <a class=annot href="#"><span class=annottext>{v : (GHC.Types.IO ()) | v == blankLine}</span><span class='hs-varid'>blankLine</span></a>
<span class=hs-linenum> 52: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>saveWeightArg</span></a> <a class=annot href="#"><span class=annottext>{v : Filesystem.Path.Internal.FilePath | v == filename}</span><span class='hs-varid'>filename</span></a>
<span class=hs-linenum> 53: </span>
<span class=hs-linenum> 54: </span>  <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>savedWeights</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>[Turtle.Line.Line] -&gt; [Main.Entry]</span><span class='hs-varid'>mapMaybe</span></a> <a class=annot href="#"><span class=annottext>Turtle.Line.Line -&gt; (GHC.Maybe.Maybe Main.Entry)</span><span class='hs-varid'>lineToEntry</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO [Turtle.Line.Line])</span><span class='hs-varid'>fold</span></a> <a class=annot href="#"><span class=annottext>(Turtle.Shell.Shell Turtle.Line.Line)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>input</span> <a class=annot href="#"><span class=annottext>{v : Filesystem.Path.Internal.FilePath | v == filename}</span><span class='hs-varid'>filename</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>forall a . (Control.Foldl.Fold a [a])</span><span class='hs-conid'>Foldl.list</span></a>
<span class=hs-linenum> 55: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>displayFromLastWeek</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == savedWeights}</span><span class='hs-varid'>savedWeights</span></a>
<span class=hs-linenum> 56: </span>
<span class=hs-linenum> 57: </span>  <a class=annot href="#"><span class=annottext>{v : (GHC.Types.IO ()) | v == blankLine}</span><span class='hs-varid'>blankLine</span></a>
<span class=hs-linenum> 58: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[(Data.Time.Calendar.Days.Day, Main.Weight)]</span><span class='hs-varid'>allDaysWithWeights</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[(Data.Time.Calendar.Days.Day, Main.Weight)]</span><span class='hs-varid'>filledDays</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == savedWeights}</span><span class='hs-varid'>savedWeights</span></a>
<span class=hs-linenum> 59: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>when</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; v == len allDaysWithWeights}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, Main.Weight)] | len v &gt;= 0
                                                    &amp;&amp; v == allDaysWithWeights}</span><span class='hs-varid'>allDaysWithWeights</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>7</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-layout'>(</span></a><span class='hs-varid'>displayMovingAverages</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, Main.Weight)] | len v &gt;= 0
                                                    &amp;&amp; v == allDaysWithWeights}</span><span class='hs-varid'>allDaysWithWeights</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 60: </span>  <span class='hs-keyword'>where</span> <a class=annot href="#"><span class=annottext>Filesystem.Path.Internal.FilePath</span><span class='hs-varid'>filename</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"/Users/matt/Dropbox/Exercise/weights.csv"</span></a>
<span class=hs-linenum> 61: </span>  <span class='hs-comment'>-- where filename = "sample.csv"</span>
<span class=hs-linenum> 62: </span>
<span class=hs-linenum> 63: </span><span class='hs-definition'>blankLine</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 64: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-definition'>blankLine</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putStrLn</span> <a class=annot href="#"><span class=annottext>forall a &lt;p :: a a -&gt; Bool&gt; .
{v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | len v == 0}</span><span class='hs-str'>""</span></a>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span><span class='hs-definition'>saveWeightArg</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Turtle.FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 67: </span><a class=annot href="#"><span class=annottext>Filesystem.Path.Internal.FilePath -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>saveWeightArg</span></a> <a class=annot href="#"><span class=annottext>Filesystem.Path.Internal.FilePath</span><span class='hs-varid'>fp</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 68: </span>  <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Main.Weight)</span><span class='hs-varid'>maybeWeight</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Types.IO (GHC.Maybe.Maybe Main.Weight)) | v == parseArgs}</span><span class='hs-varid'>parseArgs</span></a>
<span class=hs-linenum> 69: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>sequence_</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe (GHC.Types.IO ()))</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>Main.Weight -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>updateSavedWeights</span></a> <a class=annot href="#"><span class=annottext>{v : Filesystem.Path.Internal.FilePath | v == fp}</span><span class='hs-varid'>fp</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Maybe.Maybe Main.Weight) | v == maybeWeight}</span><span class='hs-varid'>maybeWeight</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 70: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Main.Weight -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>showSavedWeight</span></a> <a class=annot href="#"><span class=annottext>Main.Weight</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>putStrLn</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Weight of "</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>showWeight</span></a> <a class=annot href="#"><span class=annottext>{v : Main.Weight | v == w}</span><span class='hs-varid'>w</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>" successfully saved!"</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Types.IO ()) | v == blankLine}</span><span class='hs-varid'>blankLine</span></a>
<span class=hs-linenum> 71: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>sequence_</span></a> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe (GHC.Types.IO ()))</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>Main.Weight -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>showSavedWeight</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Maybe.Maybe Main.Weight) | v == maybeWeight}</span><span class='hs-varid'>maybeWeight</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-definition'>updateSavedWeights</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Turtle.FilePath</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Weight</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 74: </span><a class=annot href="#"><span class=annottext>Filesystem.Path.Internal.FilePath -&gt; Main.Weight -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>updateSavedWeights</span></a> <a class=annot href="#"><span class=annottext>Filesystem.Path.Internal.FilePath</span><span class='hs-varid'>path</span></a> <a class=annot href="#"><span class=annottext>Main.Weight</span><span class='hs-varid'>weight</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 75: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(Turtle.Shell.Shell Turtle.Line.Line)</span><span class='hs-varid'>orig</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Turtle.Shell.Shell Turtle.Line.Line)</span><span class='hs-varid'>input</span></a> <a class=annot href="#"><span class=annottext>{v : Filesystem.Path.Internal.FilePath | v == path}</span><span class='hs-varid'>path</span></a>
<span class=hs-linenum> 76: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(Turtle.Shell.Shell Turtle.Line.Line)</span><span class='hs-varid'>updated</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Turtle.Shell.Shell Turtle.Line.Line) | v == orig}</span><span class='hs-varid'>orig</span></a> <span class='hs-varop'>&lt;|&gt;</span> <a class=annot href="#"><span class=annottext>(Turtle.Shell.Shell Turtle.Line.Line)</span><span class='hs-varid'>liftIO</span></a> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Turtle.Line.Line)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>createEntryLine</span> <a class=annot href="#"><span class=annottext>{v : Main.Weight | v == weight}</span><span class='hs-varid'>weight</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 77: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>output</span></a> <a class=annot href="#"><span class=annottext>Filesystem.Path.Internal.FilePath</span><span class='hs-str'>"/tmp/temp_weight.csv"</span></a> <a class=annot href="#"><span class=annottext>{v : (Turtle.Shell.Shell Turtle.Line.Line) | v == updated}</span><span class='hs-varid'>updated</span></a>
<span class=hs-linenum> 78: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>cp</span></a> <a class=annot href="#"><span class=annottext>Filesystem.Path.Internal.FilePath</span><span class='hs-str'>"/tmp/temp_weight.csv"</span></a> <a class=annot href="#"><span class=annottext>{v : Filesystem.Path.Internal.FilePath | v == path}</span><span class='hs-varid'>path</span></a>
<span class=hs-linenum> 79: </span>
<span class=hs-linenum> 80: </span><span class='hs-definition'>createEntryLine</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Weight</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Line</span>
<span class=hs-linenum> 81: </span><a class=annot href="#"><span class=annottext>Main.Weight -&gt; (GHC.Types.IO Turtle.Line.Line)</span><span class='hs-definition'>createEntryLine</span></a> <a class=annot href="#"><span class=annottext>Main.Weight</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 82: </span>  <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>now</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Types.IO [GHC.Types.Char]) | v == getCurrentTimeText}</span><span class='hs-varid'>getCurrentTimeText</span></a>
<span class=hs-linenum> 83: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>line</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == now}</span><span class='hs-varid'>now</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>","</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>showWeight</span></a> <a class=annot href="#"><span class=annottext>{v : Main.Weight | v == w}</span><span class='hs-varid'>w</span></a>
<span class=hs-linenum> 84: </span>  <a class=annot href="#"><span class=annottext>forall a . a -&gt; (GHC.Types.IO a)</span><span class='hs-varid'>return</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; Turtle.Line.Line</span><span class='hs-varid'>unsafeTextToLine</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char] -&gt; {v : Data.Text.Internal.Text | tlen v == len x1}</span><span class='hs-conid'>T.pack</span></a> <span class='hs-varop'>$</span> <span class='hs-varid'>line</span>
<span class=hs-linenum> 85: </span>
<span class=hs-linenum> 86: </span><span class='hs-definition'>parseArgs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 87: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-definition'>parseArgs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Control.Monad.IO.Class.MonadIO GHC.Types.IO) | v == $fMonadIOIO}</span><span class='hs-varid'>options</span></a> <a class=annot href="#"><span class=annottext>Turtle.Options.Description</span><span class='hs-str'>"Daily Weight Tracker"</span></a> <a class=annot href="#"><span class=annottext>{v : (Options.Applicative.Types.Parser (GHC.Maybe.Maybe Main.Weight)) | v == parser}</span><span class='hs-varid'>parser</span></a>
<span class=hs-linenum> 88: </span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 89: </span>  <span class='hs-varid'>parser</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Parser</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 90: </span>  <a class=annot href="#"><span class=annottext>(Options.Applicative.Types.Parser (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-varid'>parser</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 91: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(Options.Applicative.Types.Parser (GHC.Maybe.Maybe GHC.Types.Double))</span><span class='hs-varid'>parserMaybeDouble</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 92: </span>            <a class=annot href="#"><span class=annottext>(Options.Applicative.Types.Parser (GHC.Maybe.Maybe GHC.Types.Double))</span><span class='hs-varid'>optional</span></a> <a class=annot href="#"><span class=annottext>(Options.Applicative.Types.Parser GHC.Types.Double)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>argDouble</span> <a class=annot href="#"><span class=annottext>Turtle.Options.ArgName</span><span class='hs-str'>"weight"</span></a> <a class=annot href="#"><span class=annottext>(Data.Optional.Optional Turtle.Options.HelpMessage)</span><span class='hs-str'>"Weight entry for today (must be a number)"</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 93: </span>    <span class='hs-keyword'>in</span>  <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a b .
(a -&gt; b) -&gt; (Options.Applicative.Types.Parser a) -&gt; (Options.Applicative.Types.Parser b)</span><span class='hs-varid'>fmap</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>forall a b . (a -&gt; b) -&gt; (GHC.Maybe.Maybe a) -&gt; (GHC.Maybe.Maybe b)</span><span class='hs-varid'>fmap</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Main.Weight</span><span class='hs-conid'>Weight</span></a> <a class=annot href="#"><span class=annottext>{v : (Options.Applicative.Types.Parser (GHC.Maybe.Maybe GHC.Types.Double)) | v == parserMaybeDouble}</span><span class='hs-varid'>parserMaybeDouble</span></a>
<span class=hs-linenum> 94: </span>
<span class=hs-linenum> 95: </span><span class='hs-definition'>showWeight</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Weight</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<span class=hs-linenum> 96: </span><a class=annot href="#"><span class=annottext>Main.Weight -&gt; [GHC.Types.Char]</span><span class='hs-definition'>showWeight</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Weight</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>show</span> <span class='hs-varid'>w</span>
<span class=hs-linenum> 97: </span>
<span class=hs-linenum> 98: </span><span class='hs-comment'>---------------------------------------------------------------------------</span>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Entry</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Entry</span> <span class='hs-layout'>{</span> <span class='hs-varid'>entryDate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UTCTime</span>
<span class=hs-linenum>101: </span>                   <span class='hs-layout'>,</span> <span class='hs-varid'>entryWeight</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Weight</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Show</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>DayInt</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>104: </span>
<span class=hs-linenum>105: </span><span class='hs-definition'>entryDay</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Entry</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Day</span>
<span class=hs-linenum>106: </span><a class=annot href="#"><span class=annottext>Main.Entry -&gt; Data.Time.Calendar.Days.Day</span><span class='hs-definition'>entryDay</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Time.Clock.Internal.UTCTime.UTCTime -&gt; Data.Time.Calendar.Days.Day</span><span class='hs-varid'>utctDay</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; Data.Time.Clock.Internal.UTCTime.UTCTime</span><span class='hs-varid'>entryDate</span></a>
<span class=hs-linenum>107: </span>
<span class=hs-linenum>108: </span><span class='hs-definition'>prettyPrintEntry</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Entry</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<span class=hs-linenum>109: </span><a class=annot href="#"><span class=annottext>Main.Entry -&gt; [GHC.Types.Char]</span><span class='hs-definition'>prettyPrintEntry</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Entry</span> <span class='hs-varid'>time</span> <span class='hs-layout'>(</span><span class='hs-conid'>Weight</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>110: </span>  <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>shortPrettyPrintTime</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Time.Clock.Internal.UTCTime.UTCTime | v == time}</span><span class='hs-varid'>time</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>": "</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <span class='hs-varid'>w</span>
<span class=hs-linenum>111: </span>
<span class=hs-linenum>112: </span><span class='hs-definition'>displayFromLastWeek</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>113: </span><a class=annot href="#"><span class=annottext>[Main.Entry] -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>displayFromLastWeek</span></a> <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>es</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>114: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>heading</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Addr# | v == "Entries from the past week"}</span><span class='hs-str'>"Entries from the past week"</span></a>
<span class=hs-linenum>115: </span>  <a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day</span><span class='hs-varid'>today</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>Data.Time.Clock.Internal.UTCTime.UTCTime -&gt; Data.Time.Calendar.Days.Day</span><span class='hs-varid'>utctDay</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Types.IO Data.Time.Clock.Internal.UTCTime.UTCTime) | v == getCurrentTime}</span><span class='hs-varid'>getCurrentTime</span></a>
<span class=hs-linenum>116: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>last8Days</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>fromLastNDays</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 8}</span><span class='hs-num'>8</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == today}</span><span class='hs-varid'>today</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == es}</span><span class='hs-varid'>es</span></a>
<span class=hs-linenum>117: </span>  <a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; [Main.Entry] -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>displayEntries</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == heading}</span><span class='hs-varid'>heading</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v == len last8Days}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>reverse</span> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == last8Days}</span><span class='hs-varid'>last8Days</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>118: </span>
<span class=hs-linenum>119: </span><span class='hs-definition'>fromLastNDays</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Day</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>120: </span><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; Data.Time.Calendar.Days.Day -&gt; [Main.Entry] -&gt; [Main.Entry]</span><span class='hs-definition'>fromLastNDays</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day</span><span class='hs-varid'>day</span></a> <span class='hs-keyglyph'>=</span> 
<span class=hs-linenum>121: </span>  <span class='hs-varid'>filter</span> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == n}</span><span class='hs-varid'>n</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>diffDays</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == day}</span><span class='hs-varid'>day</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>Data.Time.Clock.Internal.UTCTime.UTCTime -&gt; Data.Time.Calendar.Days.Day</span><span class='hs-varid'>utctDay</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; Data.Time.Clock.Internal.UTCTime.UTCTime</span><span class='hs-varid'>entryDate</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>122: </span>
<span class=hs-linenum>123: </span><span class='hs-definition'>displayEntries</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>124: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; [Main.Entry] -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>displayEntries</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>heading</span></a> <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>es</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>125: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>printHeading</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == heading}</span><span class='hs-varid'>heading</span></a>
<span class=hs-linenum>126: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>forM_</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == es}</span><span class='hs-varid'>es</span></a> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; (GHC.Types.IO ())</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>putStrLn</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; [GHC.Types.Char]</span><span class='hs-varid'>prettyPrintEntry</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>127: </span>
<span class=hs-linenum>128: </span><span class='hs-definition'>printHeading</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>129: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>printHeading</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>heading</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>130: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>putStrLn</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == heading}</span><span class='hs-varid'>heading</span></a> 
<span class=hs-linenum>131: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>putStrLn</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>replicate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; v == len heading}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>length</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == heading}</span><span class='hs-varid'>heading</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Char | v == (lit "61" Char)}</span><span class='hs-chr'>'='</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>132: </span>
<span class=hs-linenum>133: </span><span class='hs-definition'>displayLastN</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>134: </span><a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; [Main.Entry] -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>displayLastN</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>es</span></a> <span class='hs-keyglyph'>=</span> 
<span class=hs-linenum>135: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>heading</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Last "</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>" Entries"</span></a>
<span class=hs-linenum>136: </span>      <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | not (n &gt;= 0) =&gt; len v == 0}</span><span class='hs-varid'>lastN</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | not (n &gt;= 0) =&gt; len v == 0}</span><span class='hs-varid'>take</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v == len es}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>reverse</span> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == es}</span><span class='hs-varid'>es</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>137: </span>  <span class='hs-keyword'>in</span> <span class='hs-varid'>displayEntries</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0
                        &amp;&amp; v == heading}</span><span class='hs-varid'>heading</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | (not (n &gt;= 0) =&gt; len v == 0)
                    &amp;&amp; len v &gt;= 0
                    &amp;&amp; v == lastN}</span><span class='hs-varid'>lastN</span></a>
<span class=hs-linenum>138: </span>
<span class=hs-linenum>139: </span><span class='hs-comment'>-- {-@ type OrdDayList d = [d]&lt;{\d1 d2 -&gt; d1 &gt; d2}&gt; @-}</span>
<span class=hs-linenum>140: </span><span class='hs-comment'>-- {-@ orderedDayList :: OrdDayList Day @-}</span>
<span class=hs-linenum>141: </span><span class='hs-comment'>-- orderedDayList :: [Day]</span>
<span class=hs-linenum>142: </span><span class='hs-comment'>-- orderedDayList = ModifiedJulianDay &lt;$&gt; [5,4..1]</span>
<span class=hs-linenum>143: </span>
<span class=hs-linenum>144: </span>
<span class=hs-linenum>145: </span><span class='hs-comment'>-- Fills in missing days with the average weights from before and after that day</span>
<span class=hs-linenum>146: </span><span class='hs-definition'>filledDays</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>147: </span><a class=annot href="#"><span class=annottext>[Main.Entry] -&gt; [(Data.Time.Calendar.Days.Day, Main.Weight)]</span><span class='hs-definition'>filledDays</span></a> <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>entries</span></a> <span class='hs-keyglyph'>=</span> 
<span class=hs-linenum>148: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Main.Entry</span><span class='hs-varid'>earliestEntry</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Main.Entry</span><span class='hs-conid'>L.minimumBy</span></a> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; Main.Entry -&gt; GHC.Types.Ordering</span><span class='hs-layout'>(</span></a><span class='hs-varid'>comparing</span> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; Data.Time.Calendar.Days.Day</span><span class='hs-varid'>entryDay</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == entries}</span><span class='hs-varid'>entries</span></a>
<span class=hs-linenum>149: </span>      <a class=annot href="#"><span class=annottext>Main.Entry</span><span class='hs-varid'>latestEntry</span></a>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Main.Entry</span><span class='hs-conid'>L.maximumBy</span></a> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; Main.Entry -&gt; GHC.Types.Ordering</span><span class='hs-layout'>(</span></a><span class='hs-varid'>comparing</span> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; Data.Time.Calendar.Days.Day</span><span class='hs-varid'>entryDay</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == entries}</span><span class='hs-varid'>entries</span></a>
<span class=hs-linenum>150: </span>      <a class=annot href="#"><span class=annottext>{v : [Data.Time.Calendar.Days.Day] | len v &gt; 0}</span><span class='hs-varid'>allDays</span></a>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [Data.Time.Calendar.Days.Day] | len v &gt; 0}</span><span class='hs-varid'>fillEntries</span></a> <a class=annot href="#"><span class=annottext>{v : Main.Entry | v == earliestEntry}</span><span class='hs-varid'>earliestEntry</span></a> <a class=annot href="#"><span class=annottext>{v : Main.Entry | v == latestEntry}</span><span class='hs-varid'>latestEntry</span></a>
<span class=hs-linenum>151: </span>      <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len allDays}</span><span class='hs-varid'>filledDays</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len allDays}</span><span class='hs-varid'>fillKnownDays</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == entries}</span><span class='hs-varid'>entries</span></a> <a class=annot href="#"><span class=annottext>{v : [Data.Time.Calendar.Days.Day] | len v &gt; 0
                                     &amp;&amp; len v &gt;= 0
                                     &amp;&amp; v == allDays}</span><span class='hs-varid'>allDays</span></a>
<span class=hs-linenum>152: </span>      <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len filledDays}</span><span class='hs-varid'>leftFold</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len filledDays}</span><span class='hs-varid'>scanl1</span></a> <a class=annot href="#"><span class=annottext>(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-varid'>leftFolder</span></a> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len allDays
                                                                      &amp;&amp; len v &gt;= 0
                                                                      &amp;&amp; v == filledDays}</span><span class='hs-varid'>filledDays</span></a>
<span class=hs-linenum>153: </span>      <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len filledDays}</span><span class='hs-varid'>rightFold</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len filledDays}</span><span class='hs-varid'>scanr1</span></a> <a class=annot href="#"><span class=annottext>(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-layout'>(</span></a><span class='hs-varid'>flip</span> <a class=annot href="#"><span class=annottext>(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-varid'>leftFolder</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len allDays
                                                                      &amp;&amp; len v &gt;= 0
                                                                      &amp;&amp; v == filledDays}</span><span class='hs-varid'>filledDays</span></a>
<span class=hs-linenum>154: </span>  <span class='hs-keyword'>in</span> <span class='hs-varid'>catMaybes</span> <a class=annot href="#"><span class=annottext>{v : [(GHC.Maybe.Maybe (Data.Time.Calendar.Days.Day, Main.Weight))] | len v &lt;= len leftFold
                                                                      &amp;&amp; len v &lt;= len rightFold}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>zipWith</span> <a class=annot href="#"><span class=annottext>(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (GHC.Maybe.Maybe (Data.Time.Calendar.Days.Day, Main.Weight))</span><span class='hs-varid'>zipper</span></a> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len filledDays
                                                                      &amp;&amp; len v &gt;= 0
                                                                      &amp;&amp; v == leftFold}</span><span class='hs-varid'>leftFold</span></a> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len v == len filledDays
                                                                      &amp;&amp; len v &gt;= 0
                                                                      &amp;&amp; v == rightFold}</span><span class='hs-varid'>rightFold</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>155: </span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>156: </span>  <span class='hs-varid'>leftFolder</span>
<span class=hs-linenum>157: </span>    <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span>
<span class=hs-linenum>158: </span>  <a class=annot href="#"><span class=annottext>(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-varid'>leftFolder</span></a> <span class='hs-keyword'>_</span>      <a class=annot href="#"><span class=annottext>(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-varid'>a</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) | v == a}</span><span class='hs-varid'>a</span></a>
<span class=hs-linenum>159: </span>  <span class='hs-varid'>leftFolder</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span>  <span class='hs-varid'>d</span><span class='hs-layout'>,</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b &lt;p2 :: a b -&gt; Bool&gt; .
x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; {v : (a, b)&lt;\x5 VV -&gt; {VV : b&lt;p2 x5&gt; | true}&gt; | x_Tuple22 v == x2
                                                                                     &amp;&amp; x_Tuple21 v == x1
                                                                                     &amp;&amp; snd v == x2
                                                                                     &amp;&amp; fst v == x1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == d}</span><span class='hs-varid'>d</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Maybe.Maybe Main.Weight) | v == w}</span><span class='hs-varid'>w</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>160: </span>
<span class=hs-linenum>161: </span>  <span class='hs-varid'>zipper</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span>
<span class=hs-linenum>162: </span>  <a class=annot href="#"><span class=annottext>(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight)) -&gt; (GHC.Maybe.Maybe (Data.Time.Calendar.Days.Day, Main.Weight))</span><span class='hs-varid'>zipper</span></a> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span>            <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a . {v : (GHC.Maybe.Maybe a) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum>163: </span>  <span class='hs-varid'>zipper</span> <span class='hs-keyword'>_</span>            <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a . {v : (GHC.Maybe.Maybe a) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum>164: </span>  <span class='hs-varid'>zipper</span> <span class='hs-layout'>(</span><span class='hs-varid'>d1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>Weight</span> <span class='hs-varid'>w1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>d2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>Weight</span> <span class='hs-varid'>w2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>165: </span>    <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v &lt;=&gt; d1 /= d2}</span><span class='hs-keyword'>if</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == d1}</span><span class='hs-varid'>d1</span></a> <span class='hs-varop'>/=</span> <a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == d2}</span><span class='hs-varid'>d2</span></a> <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>forall a . {v : (GHC.Maybe.Maybe a) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Nothing</span></a> <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; {v : (GHC.Maybe.Maybe a) | fromJust v == x1
                                   &amp;&amp; (isJust v &lt;=&gt; true)}</span><span class='hs-conid'>Just</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>{v : (Data.Time.Calendar.Days.Day, Main.Weight) | x_Tuple21 v == d1
                                                  &amp;&amp; fst v == d1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == d1}</span><span class='hs-varid'>d1</span></a><span class='hs-layout'>,</span> <span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Main.Weight</span><span class='hs-conid'>Weight</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>w1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>w2</span><span class='hs-layout'>)</span> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>166: </span>
<span class=hs-linenum>167: </span><span class='hs-definition'>precision</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>168: </span><a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-definition'>precision</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>fromInteger</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-layout'>(</span></a><span class='hs-varid'>round</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == n}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 10.0}</span><span class='hs-num'>10</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i}</span><span class='hs-varid'>i</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 10.0}</span><span class='hs-num'>10</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>169: </span>
<span class=hs-linenum>170: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>average</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ ds:</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Double</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len ds &gt; 0 }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span><span class='hs-conop'>:</span><span class='hs-conid'>Double</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>171: </span><span class='hs-definition'>average</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Double</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>172: </span><a class=annot href="#"><span class=annottext>{ds : [GHC.Types.Double] | len ds &gt; 0} -&gt; GHC.Types.Double</span><span class='hs-definition'>average</span></a> <a class=annot href="#"><span class=annottext>{ds : [GHC.Types.Double] | len ds &gt; 0}</span><span class='hs-varid'>ds</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>precision</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>fromIntegral</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; v == len ds}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>length</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Double] | len v &gt; 0
                          &amp;&amp; len v &gt;= 0
                          &amp;&amp; v == ds}</span><span class='hs-varid'>ds</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Double] -&gt; GHC.Types.Double</span><span class='hs-varid'>sum</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Double] | len v &gt; 0
                          &amp;&amp; len v &gt;= 0
                          &amp;&amp; v == ds}</span><span class='hs-varid'>ds</span></a>
<span class=hs-linenum>173: </span><span class='hs-comment'>-- average ds = if null ds then 0 else precision 1 . (/ fromIntegral (length ds)) . sum $ ds</span>
<span class=hs-linenum>174: </span><span class='hs-comment'>-- average ds = if length ds == 0 then 0 else precision 1 . (/ fromIntegral (length ds)) . sum $ ds</span>
<span class=hs-linenum>175: </span>
<span class=hs-linenum>176: </span><span class='hs-comment'>-- FIXME: what if there are two weights for a day??</span>
<span class=hs-linenum>177: </span><span class='hs-definition'>dayWeightMap</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HM.HashMap</span> <span class='hs-conid'>DayInt</span> <span class='hs-conid'>Weight</span>
<span class=hs-linenum>178: </span><a class=annot href="#"><span class=annottext>[Main.Entry] -&gt; (Data.HashMap.Base.HashMap GHC.Types.Int Main.Weight)</span><span class='hs-definition'>dayWeightMap</span></a> <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>es</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>179: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>[(GHC.Types.Int, Main.Weight)]</span><span class='hs-varid'>tup</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Main.Entry -&gt; (GHC.Types.Int, Main.Weight)</span><span class='hs-varid'>fmap</span></a> <a class=annot href="#"><span class=annottext>forall a b &lt;p2 :: a b -&gt; Bool&gt; .
x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; {v : (a, b)&lt;\x5 VV -&gt; {VV : b&lt;p2 x5&gt; | true}&gt; | x_Tuple22 v == x2
                                                                                     &amp;&amp; x_Tuple21 v == x1
                                                                                     &amp;&amp; snd v == x2
                                                                                     &amp;&amp; fst v == x1}</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>Main.Entry</span><span class='hs-varid'>e</span></a> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>fromEnum</span></a> <a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day</span><span class='hs-layout'>(</span></a><span class='hs-varid'>utctDay</span> <a class=annot href="#"><span class=annottext>Data.Time.Clock.Internal.UTCTime.UTCTime</span><span class='hs-layout'>(</span></a><span class='hs-varid'>entryDate</span> <a class=annot href="#"><span class=annottext>{v : Main.Entry | v == e}</span><span class='hs-varid'>e</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Main.Weight</span><span class='hs-varid'>entryWeight</span></a> <a class=annot href="#"><span class=annottext>{v : Main.Entry | v == e}</span><span class='hs-varid'>e</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == es}</span><span class='hs-varid'>es</span></a>
<span class=hs-linenum>180: </span>  <span class='hs-keyword'>in</span>  <span class='hs-conid'>HM.fromList</span> <a class=annot href="#"><span class=annottext>{v : [(GHC.Types.Int, Main.Weight)] | len v &gt;= 0
                                      &amp;&amp; v == tup}</span><span class='hs-varid'>tup</span></a>
<span class=hs-linenum>181: </span>
<span class=hs-linenum>182: </span>
<span class=hs-linenum>183: </span><span class='hs-comment'>-- FIXME: using assume</span>
<span class=hs-linenum>184: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-varid'>fillKnownDays</span> <span class='hs-keyglyph'>::</span> 
<span class=hs-linenum>185: </span>    <span class='hs-varid'>es</span> <span class='hs-conop'>:</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> 
<span class=hs-linenum>186: </span>    <span class='hs-varid'>ds</span> <span class='hs-conop'>:</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Day</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> 
<span class=hs-linenum>187: </span>    <span class='hs-keyword'>{ rs :</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len rs == len ds }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>188: </span><span class='hs-comment'>-- {-@ fillKnownDays :: </span>
<span class=hs-linenum>189: </span><span class='hs-comment'>--     { es : [Entry] | len es &gt; 0 } -&gt; </span>
<span class=hs-linenum>190: </span><span class='hs-comment'>--     { ds : [Day] | len ds &gt; 0 } -&gt; </span>
<span class=hs-linenum>191: </span><span class='hs-comment'>--     { rs : [(Day, Maybe Weight)] | len rs &gt; 0 } @-}</span>
<span class=hs-linenum>192: </span><span class='hs-definition'>fillKnownDays</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Entry</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Day</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>193: </span><a class=annot href="#"><span class=annottext>[Main.Entry] -&gt; x2:[Data.Time.Calendar.Days.Day] -&gt; {rs : [(Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))] | len rs == len x2}</span><span class='hs-definition'>fillKnownDays</span></a> <a class=annot href="#"><span class=annottext>[Main.Entry]</span><span class='hs-varid'>es</span></a> <a class=annot href="#"><span class=annottext>[Data.Time.Calendar.Days.Day]</span><span class='hs-varid'>ds</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>194: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(Data.HashMap.Base.HashMap GHC.Types.Int Main.Weight)</span><span class='hs-varid'>entryMap</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Data.HashMap.Base.HashMap GHC.Types.Int Main.Weight)</span><span class='hs-varid'>dayWeightMap</span></a> <a class=annot href="#"><span class=annottext>{v : [Main.Entry] | len v &gt;= 0
                    &amp;&amp; v == es}</span><span class='hs-varid'>es</span></a>
<span class=hs-linenum>195: </span>  <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-varid'>dayWithWeight</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.HashMap.Base.HashMap GHC.Types.Int Main.Weight) | v == entryMap}</span><span class='hs-varid'>entryMap</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>{v : [Data.Time.Calendar.Days.Day] | len v &gt;= 0
                                     &amp;&amp; v == ds}</span><span class='hs-varid'>ds</span></a>
<span class=hs-linenum>196: </span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>197: </span>  <span class='hs-varid'>dayWithWeight</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HM.HashMap</span> <span class='hs-conid'>DayInt</span> <span class='hs-conid'>Weight</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Day</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span>
<span class=hs-linenum>198: </span>  <a class=annot href="#"><span class=annottext>(Data.HashMap.Base.HashMap GHC.Types.Int Main.Weight) -&gt; Data.Time.Calendar.Days.Day -&gt; (Data.Time.Calendar.Days.Day, (GHC.Maybe.Maybe Main.Weight))</span><span class='hs-varid'>dayWithWeight</span></a> <a class=annot href="#"><span class=annottext>(Data.HashMap.Base.HashMap GHC.Types.Int Main.Weight)</span><span class='hs-varid'>dMap</span></a> <a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day</span><span class='hs-varid'>d</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b &lt;p2 :: a b -&gt; Bool&gt; .
x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; {v : (a, b)&lt;\x5 VV -&gt; {VV : b&lt;p2 x5&gt; | true}&gt; | x_Tuple22 v == x2
                                                                                     &amp;&amp; x_Tuple21 v == x1
                                                                                     &amp;&amp; snd v == x2
                                                                                     &amp;&amp; fst v == x1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == d}</span><span class='hs-varid'>d</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Main.Weight)</span><span class='hs-conid'>HM.lookup</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromEnum</span> <a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == d}</span><span class='hs-varid'>d</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Data.HashMap.Base.HashMap GHC.Types.Int Main.Weight) | v == dMap}</span><span class='hs-varid'>dMap</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>199: </span>
<span class=hs-linenum>200: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>displayMovingAverages</span> <span class='hs-keyglyph'>::</span> 
<span class=hs-linenum>201: </span>  <span class='hs-keyword'>{ weeks :</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>| weeks &gt; 0 }</span> <span class='hs-keyglyph'>-&gt;</span> 
<span class=hs-linenum>202: </span>  <span class='hs-varid'>ls</span> <span class='hs-conop'>:</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> 
<span class=hs-linenum>203: </span>  <span class='hs-varid'>io</span> <span class='hs-conop'>:</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>204: </span><span class='hs-definition'>displayMovingAverages</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>205: </span><a class=annot href="#"><span class=annottext>{weeks : GHC.Types.Int | weeks &gt; 0} -&gt; [(Data.Time.Calendar.Days.Day, Main.Weight)] -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>displayMovingAverages</span></a> <a class=annot href="#"><span class=annottext>{weeks : GHC.Types.Int | weeks &gt; 0}</span><span class='hs-varid'>weeks</span></a> <a class=annot href="#"><span class=annottext>[(Data.Time.Calendar.Days.Day, Main.Weight)]</span><span class='hs-varid'>es</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>206: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>printHeading</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Trailing "</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt; 0
                     &amp;&amp; v == weeks}</span><span class='hs-varid'>weeks</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>" Week Averages"</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>207: </span>  <span class='hs-varid'>forM_</span> <a class=annot href="#"><span class=annottext>[(Data.Time.Calendar.Days.Day, Data.Time.Calendar.Days.Day, GHC.Types.Double)]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>movingAverages</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt; 0
                     &amp;&amp; v == weeks}</span><span class='hs-varid'>weeks</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, Main.Weight)] | len v &gt;= 0
                                                    &amp;&amp; v == es}</span><span class='hs-varid'>es</span></a></span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>start</span><span class='hs-layout'>,</span> <span class='hs-varid'>end</span><span class='hs-layout'>,</span> <span class='hs-varid'>avg</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>208: </span>    <a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>putStrLn</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>shortPrettyPrintTime</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == end}</span><span class='hs-varid'>end</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>": "</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == avg}</span><span class='hs-varid'>avg</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>209: </span>
<span class=hs-linenum>210: </span><span class='hs-comment'>-- {-@ assume divvy ::</span>
<span class=hs-linenum>211: </span><span class='hs-comment'>--     a : Nat -&gt;</span>
<span class=hs-linenum>212: </span><span class='hs-comment'>--     b : Nat -&gt;</span>
<span class=hs-linenum>213: </span><span class='hs-comment'>--     cs :[c] -&gt;</span>
<span class=hs-linenum>214: </span><span class='hs-comment'>--     { rs : [[c]] | len rs = div ((len cs) - a + b) a } @-} -- length of list and length of all elements in list</span>
<span class=hs-linenum>215: </span>
<span class=hs-linenum>216: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>movingAverages</span> <span class='hs-keyglyph'>::</span> 
<span class=hs-linenum>217: </span>    <span class='hs-keyword'>{ n :</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>| n &gt; 0 }</span> <span class='hs-keyglyph'>-&gt;</span> 
<span class=hs-linenum>218: </span>    <span class='hs-keyword'>{ ts :</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len ts &gt;= n * 7 }</span> <span class='hs-keyglyph'>-&gt;</span> 
<span class=hs-linenum>219: </span>    <span class='hs-varid'>rs</span> <span class='hs-conop'>:</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>220: </span>    <span class='hs-comment'>-- { rs : [(Day, Day, Double)] | len rs = div (len ts) n } @-}</span>
<span class=hs-linenum>221: </span><span class='hs-definition'>movingAverages</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Weight</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Day</span><span class='hs-layout'>,</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>222: </span><a class=annot href="#"><span class=annottext>x1:{n : GHC.Types.Int | n &gt; 0} -&gt; {ts : [(Data.Time.Calendar.Days.Day, Main.Weight)] | len ts &gt;= x1 * 7} -&gt; [(Data.Time.Calendar.Days.Day, Data.Time.Calendar.Days.Day, GHC.Types.Double)]</span><span class='hs-definition'>movingAverages</span></a> <a class=annot href="#"><span class=annottext>{n : GHC.Types.Int | n &gt; 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{ts : [(Data.Time.Calendar.Days.Day, Main.Weight)] | len ts &gt;= n * 7}</span><span class='hs-varid'>es</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>223: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>week</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Int# | v == 7}</span><span class='hs-num'>7</span></a>
<span class=hs-linenum>224: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == week}</span><span class='hs-varid'>windowEveryNDays</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == week}</span><span class='hs-varid'>week</span></a>
<span class=hs-linenum>225: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == week * n}</span><span class='hs-varid'>windowSize</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == week}</span><span class='hs-varid'>week</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt; 0
                     &amp;&amp; v == n}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum>226: </span>      <a class=annot href="#"><span class=annottext>[[(Data.Time.Calendar.Days.Day, Main.Weight)]]</span><span class='hs-varid'>windows</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[[(Data.Time.Calendar.Days.Day, Main.Weight)]]</span><span class='hs-varid'>reverse</span></a> <a class=annot href="#"><span class=annottext>[[(Data.Time.Calendar.Days.Day, Main.Weight)]]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>divvy</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == week * n
                     &amp;&amp; v == windowSize}</span><span class='hs-varid'>windowSize</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == week
                     &amp;&amp; v == windowEveryNDays}</span><span class='hs-varid'>windowEveryNDays</span></a> <a class=annot href="#"><span class=annottext>{v : [(Data.Time.Calendar.Days.Day, Main.Weight)] | len v &gt;= n * 7
                                                    &amp;&amp; len v &gt;= 0
                                                    &amp;&amp; v == es}</span><span class='hs-varid'>es</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>227: </span>      <a class=annot href="#"><span class=annottext>forall a .
{VV : [(a, Main.Weight)] | (not (n &gt;= 0) =&gt; len VV == 0)
                           &amp;&amp; len VV &gt;= 0} -&gt; (a, a, GHC.Types.Double)</span><span class='hs-varid'>windowResult</span></a> <a class=annot href="#"><span class=annottext>{VV : [(a, Main.Weight)] | (not (n &gt;= 0) =&gt; len VV == 0)
                           &amp;&amp; len VV &gt;= 0}</span><span class='hs-varid'>window</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt; .
x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple33 v == x3
                                                                                                                                                                &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                &amp;&amp; x_Tuple31 v == x1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>fst</span></a> <a class=annot href="#"><span class=annottext>{v : (a, Main.Weight) | v == head window}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>head</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : [(a, Main.Weight)] | (not (n &gt;= 0) =&gt; len v == 0)
                          &amp;&amp; len v &gt;= 0
                          &amp;&amp; v == window}</span><span class='hs-varid'>window</span></a></span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>fst</span></a> <a class=annot href="#"><span class=annottext>(a, Main.Weight)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>last</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : [(a, Main.Weight)] | (not (n &gt;= 0) =&gt; len v == 0)
                          &amp;&amp; len v &gt;= 0
                          &amp;&amp; v == window}</span><span class='hs-varid'>window</span></a></span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>average</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>[GHC.Types.Double]</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>Main.Weight -&gt; GHC.Types.Double</span><span class='hs-varid'>fromWeight</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>.</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a b . x1:(a, b) -&gt; {VV : b | VV == snd x1}</span><span class='hs-varid'>snd</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>&lt;$&gt;</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : [(a, Main.Weight)] | (not (n &gt;= 0) =&gt; len v == 0)
                          &amp;&amp; len v &gt;= 0
                          &amp;&amp; v == window}</span><span class='hs-varid'>window</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span>
<span class=hs-linenum>228: </span>  <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>forall a .
{v : [(a, Main.Weight)] | (not (n &gt;= 0) =&gt; len v == 0)
                          &amp;&amp; len v &gt;= 0} -&gt; (a, a, GHC.Types.Double)</span><span class='hs-varid'>windowResult</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>{v : [[(Data.Time.Calendar.Days.Day, Main.Weight)]] | len v &gt;= 0
                                                      &amp;&amp; v == windows}</span><span class='hs-varid'>windows</span></a>
<span class=hs-linenum>229: </span>
<span class=hs-linenum>230: </span><span class='hs-comment'>-- fillEntries :: Entry -&gt; Entry -&gt; [Entry] -&gt; [Entry]</span>
<span class=hs-linenum>231: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>fillEntries</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>e1</span> <span class='hs-conop'>:</span> <span class='hs-conid'>Entry</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>e2</span> <span class='hs-conop'>:</span> <span class='hs-conid'>Entry</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ ds :</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Day</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len ds &gt; 0 }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>232: </span><span class='hs-definition'>fillEntries</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Entry</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Entry</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Day</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>233: </span><span class=hs-error><a class=annot href="#"><span class=annottext>Main.Entry -&gt; Main.Entry -&gt; {ds : [Data.Time.Calendar.Days.Day] | len ds &gt; 0}</span><span class='hs-definition'>fillEntries</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Main.Entry</span><span class='hs-varid'>earliest</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Main.Entry</span><span class='hs-varid'>latest</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyglyph'>=</span></span><span class=hs-error>
</span><span class=hs-linenum>234: </span><span class=hs-error>  </span><span class=hs-error><span class='hs-keyword'>let</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day</span><span class='hs-varid'>earliestDay</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyglyph'>=</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day</span><span class='hs-varid'>utctDay</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Data.Time.Clock.Internal.UTCTime.UTCTime</span><span class='hs-layout'>(</span></a></span><span class=hs-error><span class='hs-varid'>entryDate</span></span> <a class=annot href="#"><span class=annottext>{v : Main.Entry | v == earliest}</span><span class='hs-varid'>earliest</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>235: </span><span class=hs-error>      </span><span class=hs-error><a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day</span><span class='hs-varid'>lastDay</span></a></span><span class=hs-error>     </span><span class=hs-error><span class='hs-keyglyph'>=</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Data.Time.Calendar.Days.Day</span><span class='hs-varid'>utctDay</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Data.Time.Clock.Internal.UTCTime.UTCTime</span><span class='hs-layout'>(</span></a></span><span class=hs-error><span class='hs-varid'>entryDate</span></span> <a class=annot href="#"><span class=annottext>{v : Main.Entry | v == latest}</span><span class='hs-varid'>latest</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>236: </span><span class=hs-error>  </span><span class=hs-error><span class='hs-keyword'>in</span></span><span class=hs-error>  </span><span class=hs-error><span class='hs-varid'>enumFromTo</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == earliestDay}</span><span class='hs-varid'>earliestDay</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Data.Time.Calendar.Days.Day | v == lastDay}</span><span class='hs-varid'>lastDay</span></a></span>
<span class=hs-linenum>237: </span>
<span class=hs-linenum>238: </span><span class='hs-definition'>linesToEntries</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Shell</span> <span class='hs-conid'>Line</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Shell</span> <span class='hs-conid'>Entry</span>
<span class=hs-linenum>239: </span><a class=annot href="#"><span class=annottext>(Turtle.Shell.Shell Turtle.Line.Line) -&gt; (Turtle.Shell.Shell Main.Entry)</span><span class='hs-definition'>linesToEntries</span></a> <a class=annot href="#"><span class=annottext>(Turtle.Shell.Shell Turtle.Line.Line)</span><span class='hs-varid'>sLines</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>240: </span>  <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Main.Entry)</span><span class='hs-varid'>mEntry</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>Turtle.Line.Line -&gt; (GHC.Maybe.Maybe Main.Entry)</span><span class='hs-varid'>lineToEntry</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>{v : (Turtle.Shell.Shell Turtle.Line.Line) | v == sLines}</span><span class='hs-varid'>sLines</span></a>
<span class=hs-linenum>241: </span>  <a class=annot href="#"><span class=annottext>Main.Entry -&gt; (Turtle.Shell.Shell Main.Entry)</span><span class='hs-varid'>maybe</span></a> <a class=annot href="#"><span class=annottext>forall a . (Turtle.Shell.Shell a)</span><span class='hs-varid'>mzero</span></a> <a class=annot href="#"><span class=annottext>forall a . a -&gt; (Turtle.Shell.Shell a)</span><span class='hs-varid'>return</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Maybe.Maybe Main.Entry) | v == mEntry}</span><span class='hs-varid'>mEntry</span></a>
<span class=hs-linenum>242: </span>
<span class=hs-linenum>243: </span><span class='hs-comment'>-- FIXME: Need some kind of notification coming out of this that there was a parse error (and whether </span>
<span class=hs-linenum>244: </span><span class='hs-comment'>--   the error was on the weight or the date parsing)</span>
<span class=hs-linenum>245: </span><span class='hs-definition'>lineToEntry</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Line</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Entry</span>
<span class=hs-linenum>246: </span><a class=annot href="#"><span class=annottext>Turtle.Line.Line -&gt; (GHC.Maybe.Maybe Main.Entry)</span><span class='hs-definition'>lineToEntry</span></a> <a class=annot href="#"><span class=annottext>Turtle.Line.Line</span><span class='hs-varid'>l</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>247: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>text</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-varid'>lineToText</span></a> <a class=annot href="#"><span class=annottext>{v : Turtle.Line.Line | v == l}</span><span class='hs-varid'>l</span></a>
<span class=hs-linenum>248: </span>  <span class='hs-keyword'>in</span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>[Data.Text.Internal.Text]</span><span class='hs-conid'>T.splitOn</span></a> <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text</span><span class='hs-str'>","</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | tlen v == stringlen v
                               &amp;&amp; 0 &lt;= tlen v
                               &amp;&amp; v == text}</span><span class='hs-varid'>text</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>249: </span>        <span class='hs-keyglyph'>[</span><span class='hs-varid'>date</span><span class='hs-layout'>,</span> <span class='hs-varid'>weight</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>Data.Time.Clock.Internal.UTCTime.UTCTime -&gt; Main.Weight -&gt; Main.Entry</span><span class='hs-conid'>Entry</span></a> <span class='hs-varop'>&lt;$&gt;</span> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Data.Time.Clock.Internal.UTCTime.UTCTime)</span><span class='hs-varid'>readDate</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | tlen v == stringlen v
                               &amp;&amp; 0 &lt;= tlen v
                               &amp;&amp; v == date}</span><span class='hs-varid'>date</span></a> <span class='hs-varop'>&lt;*&gt;</span> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe Main.Weight)</span><span class='hs-varid'>readWeight</span></a> <a class=annot href="#"><span class=annottext>{v : Data.Text.Internal.Text | tlen v == stringlen v
                               &amp;&amp; 0 &lt;= tlen v
                               &amp;&amp; v == weight}</span><span class='hs-varid'>weight</span></a>
<span class=hs-linenum>250: </span>        <span class='hs-keyword'>_</span>              <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall a . {v : (GHC.Maybe.Maybe a) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Nothing</span></a>
<span class=hs-linenum>251: </span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>252: </span>  <span class='hs-varid'>readWeight</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Weight</span>
<span class=hs-linenum>253: </span>  <a class=annot href="#"><span class=annottext>Data.Text.Internal.Text -&gt; (GHC.Maybe.Maybe Main.Weight)</span><span class='hs-varid'>readWeight</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Maybe.Maybe GHC.Types.Double) -&gt; (GHC.Maybe.Maybe Main.Weight)</span><span class='hs-varid'>fmap</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Main.Weight</span><span class='hs-conid'>Weight</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; (GHC.Maybe.Maybe GHC.Types.Double)</span><span class='hs-varid'>readMaybe</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>x1:Data.Text.Internal.Text -&gt; {v : [GHC.Types.Char] | len v == tlen x1}</span><span class='hs-conid'>T.unpack</span></a>
</pre>
</body>
</html>